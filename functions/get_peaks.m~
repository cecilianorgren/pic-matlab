iTime = 1;
id = 1;
it = 1;
nPeaks = 10;
spacingPeaks = 2;
iSpecies = 1;
ftmp = fxyz.f;
v = fxyz.v;
f = fxyz;

for iPeak = 1:nPeaks
[val,ind] = max(ftmp(:));
% iPeak
% val 
% ind

if val == 0 % skip if 
  continue
end

[ix,iy,iz] = ind2sub(size(ftmp),ind);
ix_ = ix+[-spacingPeaks:spacingPeaks]; ix_(ix_<0) = [];
iy_ = iy+[-spacingPeaks:spacingPeaks]; iy_(iy_<0) = [];
iz_ = iz+[-spacingPeaks:spacingPeaks]; iz_(iz_<0) = [];
ftmp(ix_,iy_,iz_) = NaN;

%             if f.v(iz)<0
%               1;
%             end
fpeaks(iPeak,id,it).vx = f.v(ix);
fpeaks(iPeak,id,it).vy = f.v(iy);
fpeaks(iPeak,id,it).vz = f.v(iz);
fpeaks(iPeak,id,it).x = mean(f.x);
fpeaks(iPeak,id,it).y = 0;
fpeaks(iPeak,id,it).z = mean(f.z);
fpeaks(iPeak,id,it).f = val;

fpeaks(iPeak,id,it).nPeaks = nPeaks;
fpeaks(iPeak,id,it).spacingPeaks = spacingPeaks;           
fpeaks(iPeak,id,it).iPeak = iPeak;
fpeaks(iPeak,id,it).iSpecies = iSpecies;
end